<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DNASeqFISHChromosomeAssignment.jl · DNASeqFISHChromosomeAssignment</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>DNASeqFISHChromosomeAssignment</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>DNASeqFISHChromosomeAssignment.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>DNASeqFISHChromosomeAssignment.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DNASeqFISHChromosomeAssignment.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CaiGroup/DNASeqFISHChromosomeAssignment.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DNASeqFISHChromosomeAssignment.jl"><a class="docs-heading-anchor" href="#DNASeqFISHChromosomeAssignment.jl">DNASeqFISHChromosomeAssignment.jl</a><a id="DNASeqFISHChromosomeAssignment.jl-1"></a><a class="docs-heading-anchor-permalink" href="#DNASeqFISHChromosomeAssignment.jl" title="Permalink"></a></h1><p>This package implements the Longest Disjoint Paths algorithm for identifying chromosome strands in DNA SeqFISH+ data. The intuition behind this method DNA SeqFISH+ is like imaging beads on an invisible string, where the loci we measure are the beads and the genomic DNA is the string. We know the spatial and genomic coordinates of each locus we find, so we can infer that DNA strands connect loci that are close both spatially and genomically.</p><p>However, we do not try to model the branching nature of replicating chromosomes. To correctly classify replicated loci on chromosome pairs that are spatially distinct, we combine the LDP chromosome identification method with DBSCAN.</p><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.assign_chromosomes" href="#DNASeqFISHChromosomeAssignment.assign_chromosomes"><code>DNASeqFISHChromosomeAssignment.assign_chromosomes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">assign_chromosomes(pnts :: DataFrame, params :: ChromSepParams, optimizer)</code></pre><p>This function assigns genomic loci from DNA seqFISH+ data to indiviual chromosomes using DBSCAN and Longest Disjoint Paths (LDP). First, genomic loci are clustering using DBSCAN. Then DBSCAN clusters that contain a proportion of unique genomic loci less than the min<em>prop</em>unique parameter set in the params object and whose average spatial distance between subsequent spatial loci is greater than the r_ldp parameter (also et in the params object) will be split, using the LDP algorithm. If these conditions are not met, then we find one LDP that is a subset of the cluster.</p><p>LDP works by finding the longest one or two weighted paths of loci of increasing genomic coordinate within the a DBSCAN cluster. More specifically, it builds a directed acyclic graph where every locus has an out going edge to genomically down stream loci within the search radius. Edges are weighted by:</p><p><span>$w = \frac{1}{g_p - g_c} × e^{-\frac{||x_p - x_c||^2}{2σ^2}}$</span></p><p>where x denotes a vector of spatial coordinates, g denotes genomic coordinates, and p and c subscripts denote parent and child nodes respectively. LDP then uses Integer Programming to find the one or two disjoint paths that maximize the sum of the weights of all edges in the paths.</p><p>Arguments</p><ul><li>df: Takes a DataFrame (pnts) of decoded DNA seqFISH data where each row describes a locus. Must include columns:</li></ul><pre><code class="nohighlight hljs">- fov : the field of view in which locus was imaged
- cellID : the cell in which the locus was imaged
- chrom : chromosome on which locus is located
- x : x spatial coordinate of locus
- y : y spatial coordinate of locus
- z : z spatial coordinate of locus
- g : genomic coordinate of locus</code></pre><ul><li>prms : ChromSepParams object containing parameters.</li><li>optimizer : optional - JuMP compatible optimizer for performing Longest Disjoint Paths optimization. Uses GLPK by default.</li></ul><p>returns a copy of the input points sorted by fov, cellID, chrom, and g with a new columns:  	<code>dbscan_allele</code> : DBSCAN clusters of each locus 	<code>dbscan_ldp_allele</code> : ldp subclusters of each dbscan cluster 	<code>dbscan_ldp_nbr_allele</code> : dbscan clusters that are not split, and expands split ldp clusters by assigning ldp neighbors to their cluster.</p><p>allele = -1 means that a locus was not assigned to a chromosome. allele &gt; 0 indicates the allele number of the chromosome that the locus was assigned to.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.ChromSepParams" href="#DNASeqFISHChromosomeAssignment.ChromSepParams"><code>DNASeqFISHChromosomeAssignment.ChromSepParams</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct ChromSepParams(
    r_dbscan :: Real
    r_ldp :: Real
    r_ldp_nbr :: Real
    sigma :: Real
    min_size :: Int64
    dbscan_min_nbrs :: Int64
    min_prop_unique :: Real
    )</code></pre><ul><li><code>r_dbscan</code> : the DBSCAN search radius</li><li><code>r_ldp</code> : the longest disjoint path search radius</li><li><code>r_ldp_nbr</code> : the search radius to add neighboring loci to LDP clusters after separating a DBSCAN cluster</li><li><code>sigma</code> : defines the weight function for how much to penalize grouping adjacent genomic loci onto the the same chromosome based on their spatial distance from each other.</li><li><code>min_size</code> : the minimum acceptable number of loci on a strand.</li><li><code>dbscan_min_pnts</code> : the minimum allowed number of points for a DBSCAN cluster. DBSCAN clusters with fewer points are discarded.</li><li><code>min_prop_unique</code> : the minimum proportion of unique loci a DBSCAN cluster is allowed to have before considering splitting it into longest disjoint paths.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.ChromSepParams-Tuple{}" href="#DNASeqFISHChromosomeAssignment.ChromSepParams-Tuple{}"><code>DNASeqFISHChromosomeAssignment.ChromSepParams</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ChromSepParams()</code></pre><p>Constructor for ChromSepParams object using the default parameter values. The user can set the parameter values using parameter setting methods.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.set_r_dbscan" href="#DNASeqFISHChromosomeAssignment.set_r_dbscan"><code>DNASeqFISHChromosomeAssignment.set_r_dbscan</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_r_dbscan(p :: ChromSepParams, r :: Real)</code></pre><p>Set the DBSCAN search radius for clustering loci.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.set_r_ldp" href="#DNASeqFISHChromosomeAssignment.set_r_ldp"><code>DNASeqFISHChromosomeAssignment.set_r_ldp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_r_ldp(p :: ChromSepParams, r :: Real)</code></pre><p>Set the longest disjoint path search radius for clustering loci.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.set_r_ldp_nbr" href="#DNASeqFISHChromosomeAssignment.set_r_ldp_nbr"><code>DNASeqFISHChromosomeAssignment.set_r_ldp_nbr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_r_ldp_nbr(p :: ChromSepParams, r :: Real)</code></pre><p>Set the search radius for clustering loci near LDPs after separating DBSCAN clusters with LDPs.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.set_sigma" href="#DNASeqFISHChromosomeAssignment.set_sigma"><code>DNASeqFISHChromosomeAssignment.set_sigma</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_sigma(p :: ChromSepParams, s :: Real)</code></pre><p>Set the sigma for the spatial distance penalty in the longest disjoint paths optimization.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.set_min_size" href="#DNASeqFISHChromosomeAssignment.set_min_size"><code>DNASeqFISHChromosomeAssignment.set_min_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_min_size(p :: ChromSepParams, min_size :: Real)</code></pre><p>Set the minimum size of DBSCAN clusters and minimum length of the longest disjoint paths.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.set_dbscan_min_nbrs" href="#DNASeqFISHChromosomeAssignment.set_dbscan_min_nbrs"><code>DNASeqFISHChromosomeAssignment.set_dbscan_min_nbrs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_dbscan_min_nbrs(p :: ChromSepParams, mns :: Int64)</code></pre><p>Set the minimum number of neighbors a locus must have within the DBSCAN radius to be incuded in a DBSCAN cluster.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DNASeqFISHChromosomeAssignment.set_minProp_unique" href="#DNASeqFISHChromosomeAssignment.set_minProp_unique"><code>DNASeqFISHChromosomeAssignment.set_minProp_unique</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_minProp_unique(p :: ChromSepParams, mpu :: Real)</code></pre><p>If the proportion of unique loci in a DBSCAN cluster is less than this, the algorithm will then check whether the  average spatial distance between loci of subsequent genomic coordinates is greater than r_ldp. If so, then the DBSCAN cluster is split into to Longest Disjoint paths.</p></div></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 7 March 2023 21:02">Tuesday 7 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
